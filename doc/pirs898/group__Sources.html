<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EGSnrc C++ class library: Particle sources</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EGSnrc C++ class library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<h1>Particle sources</h1>  </div>
</div>
<div class="contents">

<p>This module contains classes that model particle sources. If you are looking for description of how to define a certain particle source in your input file, click on the corresponding class and see the detailed description.  
<a href="#_details">More...</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__BaseSource.html">EGS_BaseSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Base source class. All particle sources must be derived from this class.  <a href="classEGS__BaseSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__BaseSpectrum.html">EGS_BaseSpectrum</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class for energy spectra. All energy spectra in the EGSnrc C++ class library are derived from this class.  <a href="classEGS__BaseSpectrum.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__BaseSimpleSource.html">EGS_BaseSimpleSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Base class for 'simple' particle sources.  <a href="classEGS__BaseSimpleSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__AngularSpreadSource.html">EGS_AngularSpreadSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A source that adds additional Gaussian angular spread to another source.  <a href="classEGS__AngularSpreadSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__BeamSource.html">EGS_BeamSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A BEAM simulation source.  <a href="classEGS__BeamSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__CollimatedSource.html">EGS_CollimatedSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A collimated particle source.  <a href="classEGS__CollimatedSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__IsotropicSource.html">EGS_IsotropicSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">An isotropic source.  <a href="classEGS__IsotropicSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__ParallelBeam.html">EGS_ParallelBeam</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A parallel beam.  <a href="classEGS__ParallelBeam.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__PhspSource.html">EGS_PhspSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A phase-space file source.  <a href="classEGS__PhspSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__PointSource.html">EGS_PointSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A point source.  <a href="classEGS__PointSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__SourceCollection.html">EGS_SourceCollection</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A source collection.  <a href="classEGS__SourceCollection.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__TransformedSource.html">EGS_TransformedSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A transformed source.  <a href="classEGS__TransformedSource.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classIAEA__PhspSource.html">IAEA_PhspSource</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">An IAEA phase-space file source.  <a href="classIAEA__PhspSource.html#_details">More...</a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This module contains classes that model particle sources. If you are looking for description of how to define a certain particle source in your input file, click on the corresponding class and see the detailed description. </p>
<h2><a class="anchor" id="sources_general"></a>
General discussion</h2>
<p>A particle source is an object that is able to deliver the charge <img class="formulaInl" alt="$q$" src="form_16.png"/>, energies <img class="formulaInl" alt="$E$" src="form_17.png"/>, positions <img class="formulaInl" alt="$\vec{x}$" src="form_1.png"/>, directions <img class="formulaInl" alt="$\vec{u}$" src="form_2.png"/> and statistical weights <img class="formulaInl" alt="$w$" src="form_18.png"/> of particles distributed according to a certain probability distribution, given a random number generator. Based on this abstraction, particle sources in the EGSnrc class library are classes derived from <a class="el" href="classEGS__BaseSource.html">an abstract base source class </a>, which specifies the interface to a particle source object. The main method in this interface is the </p>
<div class="fragment"><pre class="fragment">
getNextParticle()
</pre></div><p> function, which takes a random number generator object as input and returns the parameters of a single particle.</p>
<p>Apart from a phase-space file particle source, all other sources provided in the RZ series of EGSnrc user codes, in DOSXYZnrc and in BEAMnrc, are sources which consist of two independent objects: the first object determines the particle energy, the other object the particle position, direction and statistical weight. Because of this, there is a partial specification of the base source class, called <a class="el" href="classEGS__BaseSimpleSource.html" title="Base class for &#39;simple&#39; particle sources.">EGS_BaseSimpleSource</a>, that consists of a spectrum object and a virtual function that determines <img class="formulaInl" alt="$\vec{x}, \vec{u}$" src="form_19.png"/> and <img class="formulaInl" alt="$w$" src="form_18.png"/>. Several particle sources are derived from <a class="el" href="classEGS__BaseSimpleSource.html" title="Base class for &#39;simple&#39; particle sources.">EGS_BaseSimpleSource</a> so that they can use any spectrum together with their method for picking positions, directions and energies. In addition to the particle source class handling phase-space files and the sources derived from <a class="el" href="classEGS__BaseSimpleSource.html" title="Base class for &#39;simple&#39; particle sources.">EGS_BaseSimpleSource</a>, which can be considered as "elementary" or "primitive" sources in analogy to the elementary geometries (<em>i.e</em>. they implement the <code>getNextParticle</code> method directly, there are two "composite" sources, where the <code>getNextParticle</code> method is implemented using the <code>getNextParticle</code> methods of their constituents. It is worth noting that, unlike the sources used in the RZ series of EGSnrc user codes, DOSXYZnrc and BEAMnrc, all particle sources in the EGSnrc C++ class library are completely decoupled from the geometry. During the simulation particles are taken from the source and it is checked if the particle position is already inside the simulation geometry using its <a class="el" href="classEGS__BaseGeometry.html#af1a37ed6f281a2442a7e96d9658894a9">isWhere() </a> method. If the position is inside, or if the particle trajectory intersects the geometry (determined using the <a class="el" href="classEGS__BaseGeometry.html#a42a459b557011291ea2e8978ebee6295">howfar() </a> geometry method called with an outside region index), the particle is put on the EGSnrc particle stack with the just determined region index and its transport through the geometry is simulated. This approach permits any source to be used with any geometry in any user code using the EGSnrc C++ class library.</p>
<h2><a class="anchor" id="sources_design"></a>
Design of the egspp particle sources package</h2>
<p>All particle sources in the egspp package are derived from the <a class="el" href="classEGS__BaseSource.html" title="Base source class. All particle sources must be derived from this class.">EGS_BaseSource</a> class, which is part of the main egspp library. Classes modeling concrete particle sources are compiled into separate shared libraries (a.k.a. dynamic shared objects, DSO, or dynamically linkable library, DLL) that can be loaded dynamically at run time as needed. Each of these sources libraries provides a </p>
<div class="fragment"><pre class="fragment">
EGS_BaseSource *createSource(EGS_Input *inp)
</pre></div><p> C-style function, the address of which is resolved when a source library is loaded and is used to create a source object from the input information stored in an <a class="el" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> object and pointed to by <em>inp</em>. The information stored in the input object is typically extracted from an input file that specifies the various aspects of a particle simulation. It is of course possible to create an <a class="el" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> object specifying one or more particle sources by other means (<em>e.g</em>. within a GUI) and then use the source creation functions EGS_BaseGeometry::createSource() to obtain a pointer to the particle source object.</p>
<p>The motivation behind this design is twofold:</p>
<ul>
<li>Most of the time simulations are performed with a particle source that only requires a single class or a limited set of classes to be modeled. It would therefore be wasteful to link against a library containing all particle source classes available in egspp.</li>
<li>Extendibility: it is easy to create a new source class by deriving from <a class="el" href="classEGS__BaseSource.html" title="Base source class. All particle sources must be derived from this class.">EGS_BaseSource</a> (or <a class="el" href="classEGS__BaseSimpleSource.html" title="Base class for &#39;simple&#39; particle sources.">EGS_BaseSimpleSource</a>), implementing the necessary methods and the <code>createSource</code> function and compiling the class into a shared library that can immediately be used with the rest of the system.</li>
</ul>
<h2><a class="anchor" id="sources_common"></a>
Common sources input syntax</h2>
<p>Because the design of the particle sources package is very similar to the design of the <a class="el" href="group__Geometry.html#geometry_anchor">geometry package</a>, the input syntax of an input object specifying particle sources follows the same principles as the geometry package explained in section <a class="el" href="group__Geometry.html#geometry_common">Common geometry input syntax</a> a particle source is specified with a <code>source</code> composite property within a <code>source definition</code> property. Each source definition must define a name for the source using a <code>name</code> key and the library in which the source is found using a <code>library</code> key. For instance, </p>
<div class="fragment"><pre class="fragment">
:start source definition:
    :start source:
        library = egs_point_source
        name = some_name
        other input
    :stop source:
    simulation source = some_name
:stop source definition:
</pre></div><p> placed in the input file controlling the simulation will result in the creation of a point source named <code>some_source</code> from the library <code>egs_point_source</code>.</p>
<h2><a class="anchor" id="sources_create"></a>
Creating a new particle source</h2>
<p>The list of particle sources provided with <code>egspp</code> is by no means exhaustive. We will be adding additional sources as the need arrives. In the meantime, if your simulation problem requires a source not available with the current version of <code>egspp</code>, you will need to create your own particle source DSO. This is not very hard as demonstrated by <a href="sources_2egs__point__source_2egs__point__source_8cpp-example.html">this example</a>.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Add a general simulation source, <em>i.e</em>. a source that takes particles from some other source, simulates their transport through a geometry and collects the particles exiting/entering some region in space, and returns these when asked for a particle.</dd></dl>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
