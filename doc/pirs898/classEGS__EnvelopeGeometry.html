<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EGSnrc C++ class library: EGS_EnvelopeGeometry Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EGSnrc C++ class library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a>  </div>
  <div class="headertitle">
<h1>EGS_EnvelopeGeometry Class Reference<div class="ingroups"><a class="el" href="group__Geometry.html">Geometry module</a> &#124; <a class="el" href="group__CompositeG.html">Composite Geometries</a></div></h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="EGS_EnvelopeGeometry" --><!-- doxytag: inherits="EGS_BaseGeometry" -->
<p>An envelope geometry class.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="egs__envelope__geometry_8h_source.html">egs_envelope_geometry.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for EGS_EnvelopeGeometry:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classEGS__EnvelopeGeometry.png" usemap="#EGS_EnvelopeGeometry_map" alt=""/>
  <map id="EGS_EnvelopeGeometry_map" name="EGS_EnvelopeGeometry_map">
<area href="classEGS__BaseGeometry.html" alt="EGS_BaseGeometry" shape="rect" coords="0,0,151,24"/>
</map>
 </div></div>

<p><a href="classEGS__EnvelopeGeometry-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6696fc847b779cb583313893489cfa0e"></a><!-- doxytag: member="EGS_EnvelopeGeometry::EGS_EnvelopeGeometry" ref="a6696fc847b779cb583313893489cfa0e" args="(EGS_BaseGeometry *G, const vector&lt; EGS_BaseGeometry * &gt; &amp;geoms, const string &amp;Name=&quot;&quot;, bool newindexing=false)" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>EGS_EnvelopeGeometry</b> (<a class="el" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> *G, const vector&lt; <a class="el" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> * &gt; &amp;geoms, const string &amp;Name=&quot;&quot;, bool newindexing=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a58cb9df3ae46c7d3deb6a49712065741"></a><!-- doxytag: member="EGS_EnvelopeGeometry::isRealRegion" ref="a58cb9df3ae46c7d3deb6a49712065741" args="(int ireg) const " -->
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isRealRegion</b> (int ireg) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a38819b65630eb71b6e4a5d33188fe9b3"></a><!-- doxytag: member="EGS_EnvelopeGeometry::isInside" ref="a38819b65630eb71b6e4a5d33188fe9b3" args="(const EGS_Vector &amp;x)" -->
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isInside</b> (const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a5148fc92266b5faeffe52e6af89b10"></a><!-- doxytag: member="EGS_EnvelopeGeometry::isWhere" ref="a0a5148fc92266b5faeffe52e6af89b10" args="(const EGS_Vector &amp;x)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>isWhere</b> (const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a76e61eb0987cc5b0ca154a0d4f35635d"></a><!-- doxytag: member="EGS_EnvelopeGeometry::inside" ref="a76e61eb0987cc5b0ca154a0d4f35635d" args="(const EGS_Vector &amp;x)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>inside</b> (const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad83251822de6f21bfbb021a3ce89b68f"></a><!-- doxytag: member="EGS_EnvelopeGeometry::medium" ref="ad83251822de6f21bfbb021a3ce89b68f" args="(int ireg) const " -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>medium</b> (int ireg) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab595fcbb2ae86e5df343a7f4cc4dbd4b"></a><!-- doxytag: member="EGS_EnvelopeGeometry::computeIntersections" ref="ab595fcbb2ae86e5df343a7f4cc4dbd4b" args="(int ireg, int n, const EGS_Vector &amp;X, const EGS_Vector &amp;u, EGS_GeometryIntersections *isections)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>computeIntersections</b> (int ireg, int n, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;X, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;u, <a class="el" href="structEGS__GeometryIntersections.html">EGS_GeometryIntersections</a> *isections)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af56ceb00357e1ba537c471e3fd228267"></a><!-- doxytag: member="EGS_EnvelopeGeometry::howfarToOutside" ref="af56ceb00357e1ba537c471e3fd228267" args="(int ireg, const EGS_Vector &amp;x, const EGS_Vector &amp;u)" -->
EGS_Float&#160;</td><td class="memItemRight" valign="bottom"><b>howfarToOutside</b> (int ireg, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;x, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ddea2bb95f1b7904309f550da084cb3"></a><!-- doxytag: member="EGS_EnvelopeGeometry::howfar" ref="a9ddea2bb95f1b7904309f550da084cb3" args="(int ireg, const EGS_Vector &amp;x, const EGS_Vector &amp;u, EGS_Float &amp;t, int *newmed=0, EGS_Vector *normal=0)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>howfar</b> (int ireg, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;x, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;u, EGS_Float &amp;t, int *newmed=0, <a class="el" href="classEGS__Vector.html">EGS_Vector</a> *normal=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab2d51cca58bd92913502e6c8e1bd1265"></a><!-- doxytag: member="EGS_EnvelopeGeometry::hownear" ref="ab2d51cca58bd92913502e6c8e1bd1265" args="(int ireg, const EGS_Vector &amp;x)" -->
EGS_Float&#160;</td><td class="memItemRight" valign="bottom"><b>hownear</b> (int ireg, const <a class="el" href="classEGS__Vector.html">EGS_Vector</a> &amp;x)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73adff2c791fa810b185b8487a64fa7e"></a><!-- doxytag: member="EGS_EnvelopeGeometry::getMaxStep" ref="a73adff2c791fa810b185b8487a64fa7e" args="() const " -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>getMaxStep</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac54a7aa2042399da7d7f0d479bb12bc5"></a><!-- doxytag: member="EGS_EnvelopeGeometry::hasBooleanProperty" ref="ac54a7aa2042399da7d7f0d479bb12bc5" args="(int ireg, EGS_BPType prop) const " -->
bool&#160;</td><td class="memItemRight" valign="bottom"><b>hasBooleanProperty</b> (int ireg, EGS_BPType prop) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad271dbf326501e5c6ebb3f9062aa7e29"></a><!-- doxytag: member="EGS_EnvelopeGeometry::setBooleanProperty" ref="ad271dbf326501e5c6ebb3f9062aa7e29" args="(EGS_BPType)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setBooleanProperty</b> (EGS_BPType)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1691975385da4dcedd231825a43083e1"></a><!-- doxytag: member="EGS_EnvelopeGeometry::addBooleanProperty" ref="a1691975385da4dcedd231825a43083e1" args="(int)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>addBooleanProperty</b> (int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a62524300f180521ed946fdbde7616df9"></a><!-- doxytag: member="EGS_EnvelopeGeometry::setBooleanProperty" ref="a62524300f180521ed946fdbde7616df9" args="(EGS_BPType, int, int, int step=1)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setBooleanProperty</b> (EGS_BPType, int, int, int step=1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0cb8ead91a443edffef790aa719217f8"></a><!-- doxytag: member="EGS_EnvelopeGeometry::addBooleanProperty" ref="a0cb8ead91a443edffef790aa719217f8" args="(int, int, int, int step=1)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>addBooleanProperty</b> (int, int, int, int step=1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6b227a283e519df4f5a4be4b7806af8f"></a><!-- doxytag: member="EGS_EnvelopeGeometry::getType" ref="a6b227a283e519df4f5a4be4b7806af8f" args="() const " -->
const string &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>getType</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a59e975c0909bd244b66c071c7f7adc4a"></a><!-- doxytag: member="EGS_EnvelopeGeometry::printInfo" ref="a59e975c0909bd244b66c071c7f7adc4a" args="() const " -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>printInfo</b> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7fed6190ebf8c44115e9a415d27f791b"></a><!-- doxytag: member="EGS_EnvelopeGeometry::setRelativeRho" ref="a7fed6190ebf8c44115e9a415d27f791b" args="(int start, int end, EGS_Float rho)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setRelativeRho</b> (int start, int end, EGS_Float rho)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c73c351418ca4b7102126582060e7e6"></a><!-- doxytag: member="EGS_EnvelopeGeometry::setRelativeRho" ref="a1c73c351418ca4b7102126582060e7e6" args="(EGS_Input *)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setRelativeRho</b> (<a class="el" href="classEGS__Input.html">EGS_Input</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6264e4df92b4a84fee94d905b1854c5e"></a><!-- doxytag: member="EGS_EnvelopeGeometry::getRelativeRho" ref="a6264e4df92b4a84fee94d905b1854c5e" args="(int ireg) const " -->
EGS_Float&#160;</td><td class="memItemRight" valign="bottom"><b>getRelativeRho</b> (int ireg) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc7344ae4acfdc5f99f4fe8e5dcea708"></a><!-- doxytag: member="EGS_EnvelopeGeometry::getLabelRegions" ref="afc7344ae4acfdc5f99f4fe8e5dcea708" args="(const string &amp;str, vector&lt; int &gt; &amp;regs)" -->
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>getLabelRegions</b> (const string &amp;str, vector&lt; int &gt; &amp;regs)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#aa8f6f1697c2d18841a800d063f094b79">setMedia</a> (<a class="el" href="classEGS__Input.html">EGS_Input</a> *, int, const int *)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Don't set media for an envelope geometry.  <a href="#aa8f6f1697c2d18841a800d063f094b79"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1acc6ee7e492e82057a599ef72063d19"></a><!-- doxytag: member="EGS_EnvelopeGeometry::g" ref="a1acc6ee7e492e82057a599ef72063d19" args="" -->
<a class="el" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#a1acc6ee7e492e82057a599ef72063d19">g</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The envelope geometry. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aec01ae7bacbf81f219f2626ccebd451d"></a><!-- doxytag: member="EGS_EnvelopeGeometry::geometries" ref="aec01ae7bacbf81f219f2626ccebd451d" args="" -->
<a class="el" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#aec01ae7bacbf81f219f2626ccebd451d">geometries</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The inscribed geometries. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4b7b1275db78cb98ee79547fb3af385e"></a><!-- doxytag: member="EGS_EnvelopeGeometry::n_in" ref="a4b7b1275db78cb98ee79547fb3af385e" args="" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#a4b7b1275db78cb98ee79547fb3af385e">n_in</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of inscribed geometries. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc4c564ef9c43f78d4c1f21918a9634f"></a><!-- doxytag: member="EGS_EnvelopeGeometry::nbase" ref="abc4c564ef9c43f78d4c1f21918a9634f" args="" -->
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#abc4c564ef9c43f78d4c1f21918a9634f">nbase</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of regions in the base geometry. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#a33f8d40128843059df2e1890922da2ae">nmax</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3303daf8bd43f3f55c33c0cd1dd0884"></a><!-- doxytag: member="EGS_EnvelopeGeometry::new_indexing" ref="ac3303daf8bd43f3f55c33c0cd1dd0884" args="" -->
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#ac3303daf8bd43f3f55c33c0cd1dd0884">new_indexing</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">If true, use new indexing style. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aef032e399226660455ba519a999b99aa"></a><!-- doxytag: member="EGS_EnvelopeGeometry::reg_to_inscr" ref="aef032e399226660455ba519a999b99aa" args="" -->
int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#aef032e399226660455ba519a999b99aa">reg_to_inscr</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Region to inscribed geometry conversion. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa01b7a69fe9e702c920bc2ac4fce0c62"></a><!-- doxytag: member="EGS_EnvelopeGeometry::local_start" ref="aa01b7a69fe9e702c920bc2ac4fce0c62" args="" -->
int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#aa01b7a69fe9e702c920bc2ac4fce0c62">local_start</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">First region for each inscribed geometry. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8976ecf33794719302ff9ebda54d79b8"></a><!-- doxytag: member="EGS_EnvelopeGeometry::type" ref="a8976ecf33794719302ff9ebda54d79b8" args="" -->
static string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEGS__EnvelopeGeometry.html#a8976ecf33794719302ff9ebda54d79b8">type</a> = &quot;EGS_EnvelopeGeometry&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Geometry type. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>An envelope geometry class. </p>
<p>An envelope geometry is a geometry consisting of a base geometry <img class="formulaInl" alt="$G_B$" src="form_126.png"/> (the envelope) and one or more inscribed geometries <img class="formulaInl" alt="$G_i, i=1,...,N$" src="form_144.png"/>. As a very simple example consider a box (the envelope) and <em>e.g</em>. a sphere (the inscribed geometry) inside the box. There can be much more complex geometries modeled as envelope geometries and more examples will be given after the details of the implementation of the various geometry methods:</p>
<ul>
<li>A position is considered to be inside an envelope geometry if it inside the envelope <img class="formulaInl" alt="$G_B$" src="form_126.png"/>.</li>
<li>If the envelope consists of <img class="formulaInl" alt="$n_B$" src="form_127.png"/> regions and the inscribed geometries have <img class="formulaInl" alt="$n_1, n_2, ..., n_N$" src="form_145.png"/> regions with <img class="formulaInl" alt="$n_{\rm max}$" src="form_15.png"/> denoting the maximum of <img class="formulaInl" alt="$n_1, n_2, ..., n_N$" src="form_145.png"/>, then the region index of a point inside the envelope geometry is determined as follows:<ul>
<li>If the point is outside of all inscribed geometries, the region index is given by the region index in the envelope.</li>
<li>If the point is inside of the <img class="formulaInl" alt="$j$" src="form_13.png"/>'th inscribed geometry and the local index in this geometry is <img class="formulaInl" alt="$i_j$" src="form_146.png"/>, then the region index is given by <img class="formulaInl" alt="$n_B + n_{\rm max} (j-1) + i_j$" src="form_147.png"/>. Note that this implies that the envelope has <img class="formulaInl" alt="$n_B + n_{\rm max} N$" src="form_148.png"/> regions instead of <img class="formulaInl" alt="$n_B + n_1 + \cdots n_N$" src="form_149.png"/> as one would expect. This approach is used because during the simulation only a single global region index is kept and in order to determine if the position is in the envelope geometry or one of the inscribed geometries it is much faster to use such a region indexing scheme (if index is less than <img class="formulaInl" alt="$n_B$" src="form_127.png"/>, then the particle is in the envelope, otherwise subtract <img class="formulaInl" alt="$n_B$" src="form_127.png"/> and divide by <img class="formulaInl" alt="$n_{\rm max}$" src="form_15.png"/> to determine the index of the inscribed geometry). Such an indexing scheme is not a problem in practice as particles will never enter non-existing regions.</li>
</ul>
</li>
</ul>
<ul>
<li>If the position is outside, the howfar() method is simple: just use the howfar() method of the envelope. If the position is inside, then<ul>
<li>If the position is in one of the inscribed geometries, use the howfar() method of this geometry only. If the particle will remain in the inscribed geometry, the new region index is determined from the index of the inscribed geometry in the list of inscribed geometries and the new region index. If the particles exits the inscribed geometry, the new region index becomes the region index in the envelope.</li>
<li>If the particle is not in any of the inscribed geometries, then the distance to a boundary is given by the minimum of the distances to a boundary of the envelope or any of the inscribed geometries. The new region index is either the new region in the envelope or determined by the entry region index of the inscribed geometry being entered, depending on which distance is smallest.</li>
</ul>
</li>
<li>The hownear() is simple if the position is outside: just use the hownear() method of the envelope. If the position is inside, then<ul>
<li>If the position is inside one of the inscribed geometries, <img class="formulaInl" alt="$t_\perp$" src="form_46.png"/> is given by the hownear() method of this geometry</li>
<li>If the position is outside of all inscribed geometries, <img class="formulaInl" alt="$t_\perp$" src="form_46.png"/> is given by the minimum of the minimum perpendicular distances to the envelope and all inscribed geometries.</li>
</ul>
</li>
</ul>
<p>The above explanation makes it clear that any type of a geometry can be used as the envelope or an inscribed geometry as long as the logic applies. The conditions for the applicability of the above logic are:</p>
<ul>
<li>Inscribed geometries can not overlap. Undefined behavior will result if they do overlap (<em>e.g</em>. depending on whether the particle entered two overlapping geometries from the first or second geometry, the regions and media of that geometry will determine the transport as long as the particle remains in the geometry)</li>
<li>The envelope must completely enclose the inscribed geometries. If this is not the case and a particle enters an inscribed geometry that extends outside of the envelope, the particle will be considered inside even if it is outside the envelope for as long as the particle remains in the inscribed geometry.</li>
</ul>
<p>Apart for these two restrictions any geometries can be used. In particular, neither the envelope nor the inscribed geometries need to be elementary geometries. More complex examples of the use of this type of a composite geometry are:</p>
<ul>
<li>An XYZ-geometry inscribed in a box of air useful for <em>e.g</em>. external beam radiotherapy calculations</li>
<li>A complex geometry such as a brachytherapy seed inscribed in an XYZ geometry. One would use this type of geometry if one wanted to calculate the complete 3D dose distribution in a given voxel grid for one or more radioactive sources.</li>
<li>A complex geometry representing a detailed model of an ionization chamber inscribed in a box of water. This is very useful for dosimetry standards simulations.</li>
<li>Sets of non-concentric cylinders or spheres.</li>
</ul>
<p>One should keep in mind that an envelope geometry becomes slower with increasing number of inscribed objects. In situations with many such objects it may be advantageous to combine several objects into some other composite geometry (<em>e.g</em>. a geometry union, a stack, another envelope, etc.) before inscribing into the envelope.</p>
<p>An envelope geometry can be defined using the following keys: </p>
<div class="fragment"><pre class="fragment">
library = egs_genvelope
base geometry = name of a previously defined geometry
inscribed geometries = list of names of previously defined geometries
</pre></div><p> The above should be self explanatory. Example geometry files making use of an envelope geometry are <code>car.geom, chambers_in_box.geom, rz1.geom, seeds_in_xyz.geom</code> and <code>seeds_in_xyz1.geom</code>. </p>

<p>Definition at line <a class="el" href="egs__envelope__geometry_8h_source.html#l00179">179</a> of file <a class="el" href="egs__envelope__geometry_8h_source.html">egs_envelope_geometry.h</a>.</p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aa8f6f1697c2d18841a800d063f094b79"></a><!-- doxytag: member="EGS_EnvelopeGeometry::setMedia" ref="aa8f6f1697c2d18841a800d063f094b79" args="(EGS_Input *, int, const int *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EGS_EnvelopeGeometry::setMedia </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEGS__Input.html">EGS_Input</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Don't set media for an envelope geometry. </p>
<p>This function is re-implemented to warn the user to not set media in the envelope geometry. Instead, media should be set for the envelope and in the inscribed geometries. </p>

<p>Reimplemented from <a class="el" href="classEGS__BaseGeometry.html#aa258e78c1b9e6c70c9102def964358a4">EGS_BaseGeometry</a>.</p>

<p>Definition at line <a class="el" href="egs__envelope__geometry_8cpp_source.html#l00048">48</a> of file <a class="el" href="egs__envelope__geometry_8cpp_source.html">egs_envelope_geometry.cpp</a>.</p>

<p>References <a class="el" href="egs__functions_8cpp_source.html#l00116">egsWarning</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a33f8d40128843059df2e1890922da2ae"></a><!-- doxytag: member="EGS_EnvelopeGeometry::nmax" ref="a33f8d40128843059df2e1890922da2ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classEGS__EnvelopeGeometry.html#a33f8d40128843059df2e1890922da2ae">EGS_EnvelopeGeometry::nmax</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Max. number of regions in any inscribed geometry </p>

<p>Definition at line <a class="el" href="egs__envelope__geometry_8h_source.html#l00455">455</a> of file <a class="el" href="egs__envelope__geometry_8h_source.html">egs_envelope_geometry.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/ftessier/EGSnrc/github/EGSnrc-doc/HEN_HOUSE/egs++/geometry/egs_genvelope/<a class="el" href="egs__envelope__geometry_8h_source.html">egs_envelope_geometry.h</a></li>
<li>/home/ftessier/EGSnrc/github/EGSnrc-doc/HEN_HOUSE/egs++/geometry/egs_genvelope/<a class="el" href="egs__envelope__geometry_8cpp_source.html">egs_envelope_geometry.cpp</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
