<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EGSnrc C++ class library: /home/ftessier/EGSnrc/github/EGSnrc-doc/HEN_HOUSE/egs++/egs_shapes.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EGSnrc C++ class library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/home/ftessier/EGSnrc/github/EGSnrc-doc/HEN_HOUSE/egs++/egs_shapes.h</h1>  </div>
</div>
<div class="contents">
<a href="egs__shapes_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">###############################################################################</span>
<a name="l00003"></a>00003 <span class="comment">#</span>
<a name="l00004"></a>00004 <span class="comment">#  EGSnrc egs++ shapes headers</span>
<a name="l00005"></a>00005 <span class="comment">#  Copyright (C) 2015 National Research Council Canada</span>
<a name="l00006"></a>00006 <span class="comment">#</span>
<a name="l00007"></a>00007 <span class="comment">#  This file is part of EGSnrc.</span>
<a name="l00008"></a>00008 <span class="comment">#</span>
<a name="l00009"></a>00009 <span class="comment">#  EGSnrc is free software: you can redistribute it and/or modify it under</span>
<a name="l00010"></a>00010 <span class="comment">#  the terms of the GNU Affero General Public License as published by the</span>
<a name="l00011"></a>00011 <span class="comment">#  Free Software Foundation, either version 3 of the License, or (at your</span>
<a name="l00012"></a>00012 <span class="comment">#  option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment">#</span>
<a name="l00014"></a>00014 <span class="comment">#  EGSnrc is distributed in the hope that it will be useful, but WITHOUT ANY</span>
<a name="l00015"></a>00015 <span class="comment">#  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00016"></a>00016 <span class="comment">#  FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for</span>
<a name="l00017"></a>00017 <span class="comment">#  more details.</span>
<a name="l00018"></a>00018 <span class="comment">#</span>
<a name="l00019"></a>00019 <span class="comment">#  You should have received a copy of the GNU Affero General Public License</span>
<a name="l00020"></a>00020 <span class="comment">#  along with EGSnrc. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00021"></a>00021 <span class="comment">#</span>
<a name="l00022"></a>00022 <span class="comment">###############################################################################</span>
<a name="l00023"></a>00023 <span class="comment">#</span>
<a name="l00024"></a>00024 <span class="comment">#  Author:          Iwan Kawrakow, 2005</span>
<a name="l00025"></a>00025 <span class="comment">#</span>
<a name="l00026"></a>00026 <span class="comment">#  Contributors:    Frederic Tessier</span>
<a name="l00027"></a>00027 <span class="comment">#</span>
<a name="l00028"></a>00028 <span class="comment">###############################################################################</span>
<a name="l00029"></a>00029 <span class="comment">*/</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 
<a name="l00037"></a>00037 <span class="preprocessor">#ifndef EGS_SHAPES_</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#define EGS_SHAPES_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="egs__vector_8h.html" title="Provides methods for the manipulation of 3D vectors in cartesian co-ordinates.">egs_vector.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="egs__transformations_8h.html" title="Rotations and affine transformations header.">egs_transformations.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="egs__rndm_8h.html" title="Base random number generator.">egs_rndm.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="egs__object__factory_8h.html" title="Defines objects and object factories.">egs_object_factory.h</a>&quot;</span>
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00046"></a>00046 <span class="keyword">using</span> std::string;
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="keyword">class </span><a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a>;
<a name="l00049"></a>00049 
<a name="l00112"></a><a class="code" href="classEGS__BaseShape.html">00112</a> <span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a> : <span class="keyword">public</span> <a class="code" href="classEGS__Object.html" title="Base egspp object.">EGS_Object</a> {
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">public</span>:
<a name="l00115"></a>00115 
<a name="l00117"></a><a class="code" href="classEGS__BaseShape.html#a54e1c5f8069935cf685435acca1c2b69">00117</a>     <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00118"></a>00118         <a class="code" href="classEGS__Object.html" title="Base egspp object.">EGS_Object</a>(Name,f), T(0) { otype = <span class="stringliteral">&quot;base_shape&quot;</span>; };
<a name="l00120"></a><a class="code" href="classEGS__BaseShape.html#a9dc33d827968cc9cd8ccde94ced942d7">00120</a>     <span class="keyword">virtual</span> <a class="code" href="classEGS__BaseShape.html#a9dc33d827968cc9cd8ccde94ced942d7" title="Destructor. Deletes T if it is not null.">~EGS_BaseShape</a>() { <span class="keywordflow">if</span>(T) <span class="keyword">delete</span> T; };
<a name="l00121"></a>00121 
<a name="l00128"></a><a class="code" href="classEGS__BaseShape.html#ae334bcb57cf2605531cb527f962f40c7">00128</a>     <span class="keyword">virtual</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__BaseShape.html#ae334bcb57cf2605531cb527f962f40c7" title="Returns a random 3D vector.">getRandomPoint</a>(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm) {
<a name="l00129"></a>00129         <span class="keywordflow">if</span>( T ) <span class="keywordflow">return</span> (*T)*getPoint(rndm);
<a name="l00130"></a>00130         <span class="keywordflow">else</span> <span class="keywordflow">return</span> getPoint(rndm);
<a name="l00131"></a>00131     };
<a name="l00132"></a>00132 
<a name="l00139"></a><a class="code" href="classEGS__BaseShape.html#abb7e1253564afa1cae97dca7bacf0869">00139</a>     <span class="keyword">virtual</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__BaseShape.html#abb7e1253564afa1cae97dca7bacf0869" title="Sample and return a random 3D vector.">getPoint</a>(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm) {
<a name="l00140"></a>00140         <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56" title="Always use this function for reporting fatal errors.">egsFatal</a>(<span class="stringliteral">&quot;You need to implement the getPoint function in your &quot;</span>
<a name="l00141"></a>00141                  <span class="stringliteral">&quot;derived class\n&quot;</span>);
<a name="l00142"></a>00142         <span class="keywordflow">return</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>();
<a name="l00143"></a>00143     };
<a name="l00144"></a>00144 
<a name="l00153"></a>00153     <span class="keywordtype">void</span> setTransformation(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00154"></a>00154 
<a name="l00159"></a><a class="code" href="classEGS__BaseShape.html#a0d88fa70ebebda6b2fa1f173cb7cc2c8">00159</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseShape.html#a0d88fa70ebebda6b2fa1f173cb7cc2c8" title="Set the transformation attached to this shape.">setTransformation</a>(<a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a> *t) {
<a name="l00160"></a>00160         <span class="keywordflow">if</span>( T ) <span class="keyword">delete</span> T;
<a name="l00161"></a>00161         T = <span class="keyword">new</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a>(*t);
<a name="l00162"></a>00162     };
<a name="l00163"></a>00163 
<a name="l00166"></a><a class="code" href="classEGS__BaseShape.html#a6c5d187fe12ecf80aae323a8ab8681a3">00166</a>     <span class="keyword">const</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a> *<a class="code" href="classEGS__BaseShape.html#a6c5d187fe12ecf80aae323a8ab8681a3" title="Get a pointer to the affine transformation attached to this shape.">getTransform</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> T; };
<a name="l00167"></a>00167 
<a name="l00175"></a>00175     <span class="keyword">static</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>* createShape(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00176"></a>00176 
<a name="l00183"></a>00183     <span class="keyword">static</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>* getShape(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name);
<a name="l00184"></a>00184 
<a name="l00190"></a><a class="code" href="classEGS__BaseShape.html#a49770b9ae14073dc0aee2b0795d0b285">00190</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseShape.html#a49770b9ae14073dc0aee2b0795d0b285">supportsDirectionMethod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">false</span>; };
<a name="l00191"></a>00191 
<a name="l00204"></a><a class="code" href="classEGS__BaseShape.html#a36d3970fbe24be3b2701124a76fcef09">00204</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> getPointSourceDirection(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;xo,
<a name="l00205"></a>00205             <a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm, <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u, EGS_Float &amp;wt) {
<a name="l00206"></a>00206         <a class="code" href="group__egspp__main.html#ga4454fdf3403e87c098cd55f60dedbe56" title="Always use this function for reporting fatal errors.">egsFatal</a>(<span class="stringliteral">&quot;getPointSourceDirection: you have to implement this &quot;</span>
<a name="l00207"></a>00207             <span class="stringliteral">&quot;method for the %s shape if you want to use it\n&quot;</span>,otype.c_str());
<a name="l00208"></a>00208     };
<a name="l00209"></a>00209 
<a name="l00216"></a><a class="code" href="classEGS__BaseShape.html#a54bec7f692a6e7bbf8b57d920b6dfe91">00216</a>     <span class="keyword">virtual</span> EGS_Float area()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; };
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="keyword">protected</span>:
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a> *T; 
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 };
<a name="l00223"></a>00223 
<a name="l00234"></a><a class="code" href="classEGS__SurfaceShape.html">00234</a> <span class="keyword">class  </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__SurfaceShape.html" title="A surface shape.">EGS_SurfaceShape</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a> {
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 <span class="keyword">public</span>:
<a name="l00237"></a>00237 
<a name="l00239"></a><a class="code" href="classEGS__SurfaceShape.html#a497ce7f4e3697e56378b2d42f6d28538">00239</a>     <a class="code" href="classEGS__SurfaceShape.html" title="A surface shape.">EGS_SurfaceShape</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00240"></a>00240         <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), A(1) {};
<a name="l00242"></a><a class="code" href="classEGS__SurfaceShape.html#a819272407c3c5bfe4926d9472cd74b11">00242</a>     <a class="code" href="classEGS__SurfaceShape.html#a819272407c3c5bfe4926d9472cd74b11" title="Destructor. Does nothing.">~EGS_SurfaceShape</a>() {};
<a name="l00246"></a><a class="code" href="classEGS__SurfaceShape.html#a341a99199220265c79b4049c9e41629f">00246</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__SurfaceShape.html#a341a99199220265c79b4049c9e41629f" title="Always returns true. Shapes derived from this class must implement the getPoint() method to return po...">supportsDirectionMethod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; };
<a name="l00248"></a><a class="code" href="classEGS__SurfaceShape.html#a2c18232c9243275a28f4bb2a651bd281">00248</a>     EGS_Float <a class="code" href="classEGS__SurfaceShape.html#a2c18232c9243275a28f4bb2a651bd281" title="Returns the area of this surface shape.">area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> A; };
<a name="l00253"></a><a class="code" href="classEGS__SurfaceShape.html#aa290c002ec3e3ea654469036997d14ae">00253</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseShape.html#a36d3970fbe24be3b2701124a76fcef09">getPointSourceDirection</a>(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo,
<a name="l00254"></a>00254             <a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm, <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u, EGS_Float &amp;wt) {
<a name="l00255"></a>00255         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> xo = T ? Xo*(*T) : Xo;
<a name="l00256"></a>00256         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> x = <a class="code" href="classEGS__BaseShape.html#abb7e1253564afa1cae97dca7bacf0869" title="Sample and return a random 3D vector.">getPoint</a>(rndm);
<a name="l00257"></a>00257         u = x - xo; EGS_Float d2i = 1/u.length2(), di = sqrt(d2i);
<a name="l00258"></a>00258         u *= di; wt = A*fabs(u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a>)*d2i;
<a name="l00259"></a>00259         <span class="keywordflow">if</span>( T ) T-&gt;rotate(u);
<a name="l00260"></a><a class="code" href="classEGS__SurfaceShape.html#ae5ec007b425bc9e8d65ffeb4a4d5824b">00260</a>     };
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="keyword">protected</span>:
<a name="l00263"></a>00263 
<a name="l00269"></a>00269     EGS_Float A;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 };
<a name="l00272"></a>00272 
<a name="l00288"></a><a class="code" href="classEGS__PointShape.html">00288</a> <span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__PointShape.html" title="A point shape. This is the simplest shape possible: it simply always returns the same point...">EGS_PointShape</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a> {
<a name="l00289"></a>00289 
<a name="l00290"></a>00290 <span class="keyword">public</span>:
<a name="l00291"></a>00291 
<a name="l00293"></a><a class="code" href="classEGS__PointShape.html#a93b9113c678a6a50f3365e724b8653cd">00293</a>     <a class="code" href="classEGS__PointShape.html" title="A point shape. This is the simplest shape possible: it simply always returns the same point...">EGS_PointShape</a>(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo = <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>(),
<a name="l00294"></a>00294         <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0 ) :
<a name="l00295"></a>00295         <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), xo(Xo) { otype = <span class="stringliteral">&quot;point&quot;</span>; };
<a name="l00296"></a>00296     ~<a class="code" href="classEGS__PointShape.html" title="A point shape. This is the simplest shape possible: it simply always returns the same point...">EGS_PointShape</a>() { };
<a name="l00298"></a><a class="code" href="classEGS__PointShape.html#a8996f3704d0120ce5fb67b7c7fbf3662">00298</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__PointShape.html#a8996f3704d0120ce5fb67b7c7fbf3662" title="Returns a fixed point.">getPoint</a>(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *) { <span class="keywordflow">return</span> xo; };
<a name="l00302"></a>00302     <a class="code" href="classEGS__Object.html" title="Base egspp object.">EGS_Object</a>* <a class="code" href="classEGS__Object.html#a1048cc275a04cbffe4ec2d608fbe52dc" title="Create an object from the infromation pointed to by inp.">createObject</a>(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00303"></a>00303 
<a name="l00304"></a>00304 <span class="keyword">protected</span>:
<a name="l00305"></a>00305 
<a name="l00306"></a><a class="code" href="classEGS__PointShape.html#a47d413ede5fb9a1bbded8b17d719cec8">00306</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>  <a class="code" href="classEGS__PointShape.html#a47d413ede5fb9a1bbded8b17d719cec8" title="The point position.">xo</a>; 
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 };
<a name="l00309"></a>00309 
<a name="l00326"></a><a class="code" href="classEGS__BoxShape.html">00326</a> <span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__BoxShape.html" title="A box shape.">EGS_BoxShape</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a> {
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="keyword">protected</span>:
<a name="l00329"></a>00329 
<a name="l00330"></a><a class="code" href="classEGS__BoxShape.html#a6ef094995613a6a5463dde2f188b0519">00330</a>     EGS_Float  ax, ay, <a class="code" href="classEGS__BoxShape.html#a6ef094995613a6a5463dde2f188b0519" title="The box size.">az</a>; 
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">public</span>:
<a name="l00333"></a>00333 
<a name="l00335"></a><a class="code" href="classEGS__BoxShape.html#a9cd36077601bce3b89935288ab361316">00335</a>     <a class="code" href="classEGS__BoxShape.html" title="A box shape.">EGS_BoxShape</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00336"></a>00336         <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), ax(1), ay(1), az(1) {
<a name="l00337"></a>00337         otype=<span class="stringliteral">&quot;box&quot;</span>;
<a name="l00338"></a>00338     };
<a name="l00340"></a><a class="code" href="classEGS__BoxShape.html#ad13176988d41b2486fcd8b0c26ffbcac">00340</a>     <a class="code" href="classEGS__BoxShape.html" title="A box shape.">EGS_BoxShape</a>(EGS_Float A, <span class="keyword">const</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a> *t = 0,
<a name="l00341"></a>00341             <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00342"></a>00342             <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), ax(A), ay(A), az(A) {
<a name="l00343"></a>00343         <span class="keywordflow">if</span>( t ) T = <span class="keyword">new</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a>(*t);
<a name="l00344"></a>00344         otype=<span class="stringliteral">&quot;box&quot;</span>;
<a name="l00345"></a>00345     };
<a name="l00347"></a><a class="code" href="classEGS__BoxShape.html#ad46ec716f55ba10feb3fb4b9ac7c215f">00347</a>     <a class="code" href="classEGS__BoxShape.html" title="A box shape.">EGS_BoxShape</a>(EGS_Float Ax, EGS_Float Ay, EGS_Float Az,
<a name="l00348"></a>00348             <span class="keyword">const</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a> *t = 0,
<a name="l00349"></a>00349             <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00350"></a>00350             <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), ax(Ax), ay(Ay), az(Az) {
<a name="l00351"></a>00351         <span class="keywordflow">if</span>( t ) T = <span class="keyword">new</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a>(*t);
<a name="l00352"></a>00352         otype=<span class="stringliteral">&quot;box&quot;</span>;
<a name="l00353"></a>00353     };
<a name="l00355"></a><a class="code" href="classEGS__BoxShape.html#aef9ebb4b45565eb0031426059f14fbce">00355</a>     <a class="code" href="classEGS__BoxShape.html#aef9ebb4b45565eb0031426059f14fbce" title="Destructor. Does nothing.">~EGS_BoxShape</a>() { };
<a name="l00356"></a>00356 
<a name="l00358"></a><a class="code" href="classEGS__BoxShape.html#a809c32c1f9741bf00cd8a6f9d73cc20a">00358</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__BoxShape.html#a809c32c1f9741bf00cd8a6f9d73cc20a" title="Returns a point uniformely distributed within the box.">getPoint</a>(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm) {
<a name="l00359"></a>00359         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> v(ax*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5),
<a name="l00360"></a>00360                      ay*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5),
<a name="l00361"></a>00361                      az*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5));
<a name="l00362"></a>00362         <span class="keywordflow">return</span> v;
<a name="l00363"></a>00363     };
<a name="l00364"></a>00364 
<a name="l00368"></a>00368     <a class="code" href="classEGS__Object.html" title="Base egspp object.">EGS_Object</a>* <a class="code" href="classEGS__Object.html#a1048cc275a04cbffe4ec2d608fbe52dc" title="Create an object from the infromation pointed to by inp.">createObject</a>(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *);
<a name="l00369"></a>00369 
<a name="l00373"></a><a class="code" href="classEGS__BoxShape.html#a8ad684bd71be02e9df2a907d6c76763e">00373</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__BoxShape.html#a8ad684bd71be02e9df2a907d6c76763e" title="Returns true. (It is easy to implement the getPointSourceDirection() method for a box...">supportsDirectionMethod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; };
<a name="l00374"></a>00374 
<a name="l00379"></a><a class="code" href="classEGS__BoxShape.html#a56d0b5bfadf81926d705bd98319fd152">00379</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseShape.html#a36d3970fbe24be3b2701124a76fcef09">getPointSourceDirection</a>(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo,
<a name="l00380"></a>00380             <a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm, <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u, EGS_Float &amp;wt) {
<a name="l00381"></a>00381         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> xo = T ? Xo*(*T) : Xo;
<a name="l00382"></a>00382         EGS_Float eta = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()*<a class="code" href="classEGS__BaseShape.html#a8307bc7ddfa99a380b3ae1f9987d2464">area</a>();
<a name="l00383"></a>00383         <span class="keywordflow">if</span>( eta &lt; 2*ax*ay ) {
<a name="l00384"></a>00384             u.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = ax*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00385"></a>00385             u.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = ay*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00386"></a>00386             <span class="keywordflow">if</span>( eta &lt; ax*ay ) { u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = az/2; wt = u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> - xo.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a>; }
<a name="l00387"></a>00387             <span class="keywordflow">else</span> { u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = -az/2; wt = xo.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> - u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a>; }
<a name="l00388"></a>00388         }
<a name="l00389"></a>00389         <span class="keywordflow">else</span> <span class="keywordflow">if</span>( eta &lt; 2*(ax*ay + ax*az) ) {
<a name="l00390"></a>00390             u.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = ax*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00391"></a>00391             u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = az*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00392"></a>00392             <span class="keywordflow">if</span>( eta &lt; 2*ax*ay + ax*az ) { u.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = ay/2; wt = u.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> - xo.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a>; }
<a name="l00393"></a>00393             <span class="keywordflow">else</span> { u.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = -ay/2; wt = xo.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> - u.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a>; }
<a name="l00394"></a>00394         }
<a name="l00395"></a>00395         <span class="keywordflow">else</span> {
<a name="l00396"></a>00396             eta -= 2*(ax*ay + ax*az);
<a name="l00397"></a>00397             u.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = ay*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00398"></a>00398             u.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = az*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00399"></a>00399             <span class="keywordflow">if</span>( eta &lt; ay*az ) { u.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = ax/2; wt = u.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> - xo.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a>; }
<a name="l00400"></a>00400             <span class="keywordflow">else</span> { u.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = -ax/2; wt = xo.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> - u.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a>; }
<a name="l00401"></a>00401         }
<a name="l00402"></a>00402         u -= xo; EGS_Float d2 = u.length2(), d = sqrt(d2);
<a name="l00403"></a>00403         u *= (1/d); wt *= (<a class="code" href="classEGS__BaseShape.html#a8307bc7ddfa99a380b3ae1f9987d2464">area</a>()/(d2*d));
<a name="l00404"></a>00404         <span class="keywordflow">if</span>( T ) T-&gt;rotate(u);
<a name="l00405"></a>00405     };
<a name="l00407"></a><a class="code" href="classEGS__BoxShape.html#a1e5bbc7386af31f08540638247b66d5b">00407</a>     EGS_Float <a class="code" href="classEGS__BoxShape.html#a1e5bbc7386af31f08540638247b66d5b" title="Returns the box surface area.">area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2*(ax*ay + ax*az + ay*az); };
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 };
<a name="l00410"></a>00410 
<a name="l00428"></a><a class="code" href="classEGS__SphereShape.html">00428</a> <span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__SphereShape.html" title="A sphere shape.">EGS_SphereShape</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a> {
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="keyword">protected</span>:
<a name="l00431"></a>00431 
<a name="l00432"></a><a class="code" href="classEGS__SphereShape.html#aaf94011657138b86598fbcfa0f9e5809">00432</a>     EGS_Float  <a class="code" href="classEGS__SphereShape.html#aaf94011657138b86598fbcfa0f9e5809" title="The sphere radius.">R</a>;     
<a name="l00433"></a><a class="code" href="classEGS__SphereShape.html#ad5d45d3bc6ff77988720db0258f3ce7e">00433</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__SphereShape.html#ad5d45d3bc6ff77988720db0258f3ce7e" title="The sphere midpoint.">xo</a>;    
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 <span class="keyword">public</span>:
<a name="l00436"></a>00436 
<a name="l00438"></a><a class="code" href="classEGS__SphereShape.html#a0a81fe670f878c83b60a6802f4a6c49f">00438</a>     <a class="code" href="classEGS__SphereShape.html" title="A sphere shape.">EGS_SphereShape</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00439"></a>00439         <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), R(1), xo() { otype=<span class="stringliteral">&quot;sphere&quot;</span>; };
<a name="l00441"></a><a class="code" href="classEGS__SphereShape.html#a1ed3c73a23bb4044fbf89e8b1b893b23">00441</a>     <a class="code" href="classEGS__SphereShape.html" title="A sphere shape.">EGS_SphereShape</a>(EGS_Float r, <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo = <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>(0,0,0),
<a name="l00442"></a>00442         <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00443"></a>00443         <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), R(r), xo(Xo) { otype = <span class="stringliteral">&quot;sphere&quot;</span>; };
<a name="l00445"></a><a class="code" href="classEGS__SphereShape.html#a6f1cfc18fb2c22dceb0c095b7272be60">00445</a>     <a class="code" href="classEGS__SphereShape.html#a6f1cfc18fb2c22dceb0c095b7272be60">~EGS_SphereShape</a>() {};
<a name="l00446"></a>00446 
<a name="l00448"></a><a class="code" href="classEGS__SphereShape.html#aa0fdd4cfef27a7bca76a5232412715e1">00448</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__SphereShape.html#aa0fdd4cfef27a7bca76a5232412715e1" title="Returns a random point within the sphere.">getPoint</a>(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm) {
<a name="l00449"></a>00449         EGS_Float r = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>(), r1 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>(),
<a name="l00450"></a>00450                  r2 = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>();
<a name="l00451"></a>00451         <span class="keywordflow">if</span>( r1 &gt; r ) r = r1;
<a name="l00452"></a>00452         <span class="keywordflow">if</span>( r2 &gt; r ) r = r2;
<a name="l00453"></a>00453         EGS_Float cost = 2*rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-1;
<a name="l00454"></a>00454         EGS_Float sint = sqrt(1-cost*cost); r1 = R*r*sint;
<a name="l00455"></a>00455         EGS_Float cphi, sphi; rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#a1a8125374996eec60b8e017aca93c047" title="Sets cphi and sphi to the cosine and sine of a random angle uniformely distributed between 0 and ...">getAzimuth</a>(cphi,sphi);
<a name="l00456"></a>00456         <span class="keywordflow">return</span> xo + <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>(r1*cphi,r1*sphi,R*r*cost);
<a name="l00457"></a>00457     };
<a name="l00458"></a>00458 
<a name="l00462"></a>00462     <a class="code" href="classEGS__Object.html" title="Base egspp object.">EGS_Object</a>* <a class="code" href="classEGS__Object.html#a1048cc275a04cbffe4ec2d608fbe52dc" title="Create an object from the infromation pointed to by inp.">createObject</a>(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00463"></a>00463 
<a name="l00467"></a><a class="code" href="classEGS__SphereShape.html#ae3fd08d6c77a1221311242d4dcd0acf5">00467</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__SphereShape.html#ae3fd08d6c77a1221311242d4dcd0acf5" title="Returns true. (It is easy to implement the getPointSourceDirection() method for a sphere...">supportsDirectionMethod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; };
<a name="l00468"></a>00468 
<a name="l00473"></a><a class="code" href="classEGS__SphereShape.html#a53834fa055061e1953b0289ff801232b">00473</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseShape.html#a36d3970fbe24be3b2701124a76fcef09">getPointSourceDirection</a>(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo,
<a name="l00474"></a>00474             <a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm, <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u, EGS_Float &amp;wt) {
<a name="l00475"></a>00475         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> xo = T ? Xo*(*T) : Xo;
<a name="l00476"></a>00476         EGS_Float cost = 2*rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-1;
<a name="l00477"></a>00477         EGS_Float sint = 1-cost*cost;
<a name="l00478"></a>00478         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> x;
<a name="l00479"></a>00479         <span class="keywordflow">if</span>( sint &gt; 1e-10 ) {
<a name="l00480"></a>00480             EGS_Float cphi, sphi; rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#a1a8125374996eec60b8e017aca93c047" title="Sets cphi and sphi to the cosine and sine of a random angle uniformely distributed between 0 and ...">getAzimuth</a>(cphi,sphi);
<a name="l00481"></a>00481             sint = R*sqrt(sint);
<a name="l00482"></a>00482             x.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = sint*cphi; x.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = sint*sphi; x.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = R*cost;
<a name="l00483"></a>00483         }
<a name="l00484"></a>00484         <span class="keywordflow">else</span> x.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = R*cost;
<a name="l00485"></a>00485         u = (x + this-&gt;xo) - xo; EGS_Float di = 1/u.length();  u *= di;
<a name="l00486"></a>00486         wt = u*x*4*M_PI*R*di*di;
<a name="l00487"></a>00487     };
<a name="l00489"></a><a class="code" href="classEGS__SphereShape.html#a76d385c1e458e44f16e5042770e9dab7">00489</a>     EGS_Float <a class="code" href="classEGS__SphereShape.html#a76d385c1e458e44f16e5042770e9dab7" title="Returns the sphere surface area.">area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 4*M_PI*R*R; };
<a name="l00490"></a>00490 };
<a name="l00491"></a>00491 
<a name="l00515"></a><a class="code" href="classEGS__CylinderShape.html">00515</a> <span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__CylinderShape.html" title="A cylinder shape.">EGS_CylinderShape</a> : <span class="keyword">public</span> <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a> {
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="keyword">protected</span>:
<a name="l00518"></a>00518 
<a name="l00519"></a><a class="code" href="classEGS__CylinderShape.html#aa302cfc9c8c0885f8459506c979dd603">00519</a>     EGS_Float  <a class="code" href="classEGS__CylinderShape.html#aa302cfc9c8c0885f8459506c979dd603" title="Cylinder radius.">R</a>;       
<a name="l00520"></a><a class="code" href="classEGS__CylinderShape.html#a35a86f084a4b5f6192675e1afda17784">00520</a>     EGS_Float  <a class="code" href="classEGS__CylinderShape.html#a35a86f084a4b5f6192675e1afda17784" title="Cylinder height.">h</a>;       
<a name="l00521"></a><a class="code" href="classEGS__CylinderShape.html#accb7ea0569784b9ce83f6e3fd71709dc">00521</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__CylinderShape.html#accb7ea0569784b9ce83f6e3fd71709dc" title="midpoint">xo</a>;      
<a name="l00522"></a><a class="code" href="classEGS__CylinderShape.html#a4ea94bbd5b59e593004d4bada208a155">00522</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__CylinderShape.html#a4ea94bbd5b59e593004d4bada208a155" title="Cylinder axis.">a</a>;       
<a name="l00523"></a>00523     EGS_Float  phi_min;
<a name="l00524"></a>00524     EGS_Float  phi_max;
<a name="l00525"></a><a class="code" href="classEGS__CylinderShape.html#a5b1d808e7f9cfffd6a8a6ca264e0b055">00525</a>     <span class="keywordtype">bool</span>       <a class="code" href="classEGS__CylinderShape.html#a5b1d808e7f9cfffd6a8a6ca264e0b055" title="True, if azimuthal range restricted.">has_phi</a>; 
<a name="l00526"></a>00526 
<a name="l00528"></a><a class="code" href="classEGS__CylinderShape.html#a2673871401d75e7902e3e8b61c74d792">00528</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> getPointInCircle(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm, EGS_Float &amp;x,
<a name="l00529"></a>00529             EGS_Float &amp;y) {
<a name="l00530"></a>00530         <span class="keywordflow">if</span>( !has_phi ) {
<a name="l00531"></a>00531             <span class="keywordflow">do</span> { x = 2*rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-1; y = 2*rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-1; }
<a name="l00532"></a>00532             <span class="keywordflow">while</span>( x*x + y*y &gt; 1);
<a name="l00533"></a>00533             x *= R; y *= R;
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535         <span class="keywordflow">else</span> {
<a name="l00536"></a>00536             EGS_Float r = R*sqrt(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>());
<a name="l00537"></a>00537             EGS_Float eta = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>();
<a name="l00538"></a>00538             EGS_Float phi = phi_min*(1-eta) + phi_max*eta;
<a name="l00539"></a>00539             x = r*cos(phi); y = r*sin(phi);
<a name="l00540"></a>00540         }
<a name="l00541"></a>00541     };
<a name="l00542"></a>00542 
<a name="l00543"></a>00543 
<a name="l00544"></a>00544 <span class="keyword">public</span>:
<a name="l00545"></a>00545 
<a name="l00549"></a><a class="code" href="classEGS__CylinderShape.html#a580091b8ebd572a7c54e617c38661d41">00549</a>     <a class="code" href="classEGS__CylinderShape.html" title="A cylinder shape.">EGS_CylinderShape</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00550"></a>00550         <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(), R(1), h(1), xo(), a(0,0,1),
<a name="l00551"></a>00551         phi_min(0), phi_max(2*M_PI), has_phi(false) { otype=<span class="stringliteral">&quot;cylinder&quot;</span>;};
<a name="l00552"></a>00552     <a class="code" href="classEGS__CylinderShape.html" title="A cylinder shape.">EGS_CylinderShape</a>(EGS_Float r, EGS_Float H,
<a name="l00553"></a>00553             <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo = <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>(0,0,0),
<a name="l00554"></a>00554             <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;A = <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>(0,0,1),
<a name="l00555"></a>00555             <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00556"></a>00556             <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), R(r), h(H), xo(Xo), a(A),
<a name="l00557"></a>00557             phi_min(0), phi_max(2*M_PI), has_phi(false) {
<a name="l00558"></a>00558         <a class="code" href="classEGS__RotationMatrix.html" title="A class for vector rotations.">EGS_RotationMatrix</a> rmat(a);
<a name="l00559"></a>00559         <span class="keywordflow">if</span>( xo.length2() &gt; 1e-10 || !rmat.isI() )
<a name="l00560"></a>00560             T = <span class="keyword">new</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a>(rmat.inverse(),xo);
<a name="l00561"></a>00561         otype=<span class="stringliteral">&quot;cylinder&quot;</span>;
<a name="l00562"></a>00562     };
<a name="l00566"></a><a class="code" href="classEGS__CylinderShape.html#a4a88b562bb7c13171ed2948363305059">00566</a>     <a class="code" href="classEGS__CylinderShape.html" title="A cylinder shape.">EGS_CylinderShape</a>(EGS_Float r, EGS_Float H, <span class="keyword">const</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a> *t,
<a name="l00567"></a>00567             <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name=<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="classEGS__ObjectFactory.html" title="An object factory.">EGS_ObjectFactory</a> *f=0) :
<a name="l00568"></a>00568          <a class="code" href="classEGS__BaseShape.html" title="Base shape class. All shapes in the EGSnrc C++ class library are derived from EGS_BaseShape.">EGS_BaseShape</a>(Name,f), R(r), h(H),
<a name="l00569"></a>00569          phi_min(0), phi_max(2*M_PI), has_phi(false) {
<a name="l00570"></a>00570         <span class="keywordflow">if</span>( t ) T = <span class="keyword">new</span> <a class="code" href="classEGS__AffineTransform.html" title="A class providing affine transformations.">EGS_AffineTransform</a>(*t);
<a name="l00571"></a>00571         otype=<span class="stringliteral">&quot;cylinder&quot;</span>;
<a name="l00572"></a>00572     };
<a name="l00574"></a><a class="code" href="classEGS__CylinderShape.html#a73c018c69cf936059d46c69d19264e63">00574</a>     <a class="code" href="classEGS__CylinderShape.html#a73c018c69cf936059d46c69d19264e63">~EGS_CylinderShape</a>() { };
<a name="l00575"></a>00575 
<a name="l00577"></a><a class="code" href="classEGS__CylinderShape.html#a2b22a214a767a51ace13551bdea8c7b8">00577</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__CylinderShape.html#a2b22a214a767a51ace13551bdea8c7b8">setPhiRange</a>(EGS_Float Phi_min, EGS_Float Phi_max) {
<a name="l00578"></a>00578         <span class="keywordflow">if</span>( Phi_min &lt; Phi_max ) { phi_min = Phi_min; phi_max = Phi_max; }
<a name="l00579"></a>00579         <span class="keywordflow">else</span>                    { phi_min = Phi_max; phi_max = Phi_min; }
<a name="l00580"></a>00580         <span class="keywordflow">if</span>( phi_max - phi_min &lt; 1.99999*M_PI ) has_phi = <span class="keyword">true</span>;
<a name="l00581"></a>00581         <span class="keywordflow">else</span> has_phi = <span class="keyword">false</span>;
<a name="l00582"></a>00582     };
<a name="l00583"></a>00583 
<a name="l00587"></a><a class="code" href="classEGS__CylinderShape.html#a69affe00ee17526f6c93f897f78aa8cf">00587</a>     <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> <a class="code" href="classEGS__CylinderShape.html#a69affe00ee17526f6c93f897f78aa8cf" title="Samples and returns a point uniformly distributed within the cylinder.">getPoint</a>(<a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm) {
<a name="l00588"></a>00588         EGS_Float x,y; getPointInCircle(rndm,x,y);
<a name="l00589"></a>00589         EGS_Float z = h*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00590"></a>00590         <span class="keywordflow">return</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a>(x,y,z);
<a name="l00591"></a>00591     };
<a name="l00592"></a>00592 
<a name="l00596"></a>00596     <a class="code" href="classEGS__Object.html" title="Base egspp object.">EGS_Object</a>* <a class="code" href="classEGS__Object.html#a1048cc275a04cbffe4ec2d608fbe52dc" title="Create an object from the infromation pointed to by inp.">createObject</a>(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *);
<a name="l00597"></a>00597 
<a name="l00599"></a><a class="code" href="classEGS__CylinderShape.html#aceb4481f39ca53417e15fc88a52c017f">00599</a>     EGS_Float <a class="code" href="classEGS__CylinderShape.html#aceb4481f39ca53417e15fc88a52c017f">getRadius</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> R; };
<a name="l00601"></a><a class="code" href="classEGS__CylinderShape.html#a5880060387742934aaaa04e1b2045ba4">00601</a>     EGS_Float <a class="code" href="classEGS__CylinderShape.html#a5880060387742934aaaa04e1b2045ba4">getHeight</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> h; };
<a name="l00602"></a>00602 
<a name="l00606"></a><a class="code" href="classEGS__CylinderShape.html#ae0c78f152f0bb73221e59eb951760b3e">00606</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__CylinderShape.html#ae0c78f152f0bb73221e59eb951760b3e" title="Returns true. (It is easy to implement the getPointSourceDirection() method for a cylinder...">supportsDirectionMethod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; };
<a name="l00607"></a>00607 
<a name="l00612"></a><a class="code" href="classEGS__CylinderShape.html#a059efbd0ba7315b6cc8a1b2c0133d9bd">00612</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseShape.html#a36d3970fbe24be3b2701124a76fcef09">getPointSourceDirection</a>(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;Xo,
<a name="l00613"></a>00613             <a class="code" href="classEGS__RandomGenerator.html" title="Base random number generator class. All random number generators should be derived from this class...">EGS_RandomGenerator</a> *rndm, <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u, EGS_Float &amp;wt) {
<a name="l00614"></a>00614         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> xo = T ? Xo*(*T) : Xo;
<a name="l00615"></a>00615         EGS_Float eta = rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()*(R+h);
<a name="l00616"></a>00616         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> x;                               <span class="comment">// point on cylinder with respect to midpoint</span>
<a name="l00617"></a>00617         <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> n;                               <span class="comment">// normal to cylinder at point x</span>
<a name="l00618"></a>00618         <span class="keywordflow">if</span>( eta &lt; R ) {
<a name="l00619"></a>00619             getPointInCircle(rndm,x.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a>,x.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a>);
<a name="l00620"></a>00620             <span class="keywordflow">if</span>( 2*eta &lt; R ) { x.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = h/2; n.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = 1; } <span class="comment">// top face: normal is up</span>
<a name="l00621"></a>00621             <span class="keywordflow">else</span> { x.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = -h/2; n.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = -1; }          <span class="comment">// bottom face: normal is down</span>
<a name="l00622"></a>00622         }
<a name="l00623"></a>00623         <span class="keywordflow">else</span> {
<a name="l00624"></a>00624             EGS_Float cphi,sphi; rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#a1a8125374996eec60b8e017aca93c047" title="Sets cphi and sphi to the cosine and sine of a random angle uniformely distributed between 0 and ...">getAzimuth</a>(cphi,sphi);
<a name="l00625"></a>00625             x.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = R*cphi; x.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = R*sphi; x.<a class="code" href="classEGS__Vector.html#a4d45f2e6f756337d6b06b006e04bfc87" title="z-component">z</a> = h*(rndm-&gt;<a class="code" href="classEGS__RandomGenerator.html#abad39a80b392acb3ab7935db0bd94b79" title="Returns a random number uniformly distributed between zero (inclusive) and 1 (exclusive).">getUniform</a>()-0.5);
<a name="l00626"></a>00626             n.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a> = x.<a class="code" href="classEGS__Vector.html#aa67c962f9024c44d15f446c122d25cbf" title="x-component">x</a>; n.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a> = x.<a class="code" href="classEGS__Vector.html#a156335a0c0cee0f4c6f6e23aac316350" title="y-component">y</a>;                   <span class="comment">// side face: normal is (x,y)</span>
<a name="l00627"></a>00627         }
<a name="l00628"></a>00628         u = (x+this-&gt;xo) - xo;                      <span class="comment">// direction vector from origin to cylinder point</span>
<a name="l00629"></a>00629         EGS_Float d2 = u.length2(), d = sqrt(d2);
<a name="l00630"></a>00630         u *= (1/d);                                 <span class="comment">// normalize direction vectors</span>
<a name="l00631"></a>00631         n.normalize();                              <span class="comment">// normalize normal</span>
<a name="l00632"></a>00632         wt = u*n*<a class="code" href="classEGS__BaseShape.html#a8307bc7ddfa99a380b3ae1f9987d2464">area</a>()/d2;
<a name="l00633"></a>00633         <span class="keywordflow">if</span>( T ) T-&gt;rotate(u);
<a name="l00634"></a>00634     };
<a name="l00636"></a><a class="code" href="classEGS__CylinderShape.html#a5f7f0d3f1d6397316a87c370b5f5ab8d">00636</a>     EGS_Float <a class="code" href="classEGS__CylinderShape.html#a5f7f0d3f1d6397316a87c370b5f5ab8d" title="Returns the cylinder surface area.">area</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2*M_PI*R*(R+h); };
<a name="l00637"></a>00637 };
<a name="l00638"></a>00638 
<a name="l00639"></a>00639 <span class="preprocessor">#endif</span>
<a name="l00640"></a>00640 <span class="preprocessor"></span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
